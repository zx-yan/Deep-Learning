# 深度学习模型评价指标综述

## 一、分类任务 (Classification Tasks)

分类任务的评价基础是**混淆矩阵 (Confusion Matrix)**，定义如下：
* **TP (True Positive)**：真阳性（预测为正，实际为正）
* **FP (False Positive)**：假阳性（预测为正，实际为负）
* **FN (False Negative)**：假阴性（预测为负，实际为正）
* **TN (True Negative)**：真阴性（预测为负，实际为负）

### 1. 基础指标

| 指标名称 | 英文 | 公式 | 物理含义与特性 |
| :--- | :--- | :--- | :--- |
| **准确率** | Accuracy | `(TP + TN) / (TP + TN + FP + FN)` | 模型正确分类样本占总样本的比例。**局限**：在类别极度不平衡时失效（Accuracy Paradox）。 |
| **精确率** | Precision | `TP / (TP + FP)` | 查准率。预测为正例的样本中，实际为正例的比例。**适用**：对误报（False Positive）敏感的场景（如垃圾邮件过滤）。 |
| **召回率** | Recall | `TP / (TP + FN)` | 查全率（亦称灵敏度 Sensitivity）。实际为正例的样本中，被正确预测的比例。**适用**：对漏报（False Negative）敏感的场景（如疾病筛查）。 |
| **F1分数** | F1-Score | `2 × (Precision × Recall) / (Precision + Recall)` | 精确率与召回率的**调和平均数**。**特性**：综合衡量模型性能，适用于类别不平衡场景。 |

### 2. 阈值与曲线指标

* **ROC曲线 (Receiver Operating Characteristic Curve)**
  * **定义**：以假阳性率 `FPR = FP/(FP + TN)` 为横轴，真阳性率 `TPR = TP/(TP + FN)` (Recall) 为纵轴绘制的曲线。
  * **AUC (Area Under Curve)**：ROC曲线下的面积，取值范围 `[0.5, 1]`。
  * **特性**：具有**类别不平衡鲁棒性**，衡量模型在不同阈值下的综合排序能力。
* **PR曲线 (Precision-Recall Curve)**
  * **定义**：以 Recall 为横轴，Precision 为纵轴绘制的曲线。
  * **特性**：在正样本极其稀少（极度不平衡）的情况下，比 ROC 曲线更能反映模型的真实性能。

### 3. 多分类聚合策略

当存在多个类别时，需将二分类指标扩展至多分类：
* **宏平均 (Macro-Average)**：计算每个类别的指标（如 F1）后取算术平均。
  * *特性*：平等对待每个类别，受小样本类别影响大。
* **微平均 (Micro-Average)**：先汇总所有类别的 TP、FP、FN，再计算全局指标。
  * *特性*：受大样本类别主导。
* **加权平均 (Weighted-Average)**：按各类别的样本数量加权求和。

### 4. 概率类指标

* **对数损失 (Log Loss / Cross-Entropy Loss)**
  * **公式**：`L = -1/N × Σ[y_i × log(ŷ_i) + (1-y_i) × log(1-ŷ_i)]`
  * **特性**：不仅衡量分类的正确性，还衡量预测概率的置信度。预测错误且置信度高时，惩罚最大。

---

## 二、回归任务 (Regression Tasks)

用于评估连续数值预测模型的误差。

| 指标名称 | 公式 | 特性与适用性 |
| :--- | :--- | :--- |
| **平均绝对误差 (MAE)** | `1/n × Σ|y_i - ŷ_i|` | L1 范数损失。对离群值（Outliers）具有鲁棒性，解释性强。 |
| **均方误差 (MSE)** | `1/n × Σ(y_i - ŷ_i)^2` | L2 范数损失。对大误差惩罚更重，对离群值敏感。 |
| **均方根误差 (RMSE)** | `√MSE` | 量纲与原变量一致，便于直观解释。 |
| **决定系数 (R²)** | `1 - Σ(y_i - ŷ_i)² / Σ(y_i - ȳ)²` | 衡量模型拟合优度，表示模型解释了数据方差的比例。最佳值为 1。 |
| **平均绝对百分比误差 (MAPE)** | `100% / n × Σ|(y_i - ŷ_i)/y_i|` | 衡量相对误差。当真实值 y_i 接近 0 时数值不稳定。 |

---

## 三、目标检测 (Object Detection)

### 1. 交并比 (IoU - Intersection over Union)
衡量预测边界框 (Prediction) 与真实边界框 (Ground Truth) 的重叠程度。
`IoU = Area(交集) / Area(并集)`
* 通常设定 `IoU ≥ 0.5` 为检测正确 (TP)。

### 2. 平均精度 (AP) 与平均精度均值 (mAP)
* **AP (Average Precision)**：对于单个类别，计算 PR 曲线下的面积（通常采用插值法计算）。
* **mAP (Mean Average Precision)**：所有类别的 AP 的算术平均值。
  * **mAP@0.5 (PASCAL VOC标准)**：IoU 阈值设为 0.5 时的 mAP。
  * **mAP@0.5:0.95 (COCO标准)**：IoU 阈值从 0.5 到 0.95，步长 0.05，计算 10 个 mAP 后取平均。**更能反映高精度定位能力。**

---

## 四、语义分割 (Semantic Segmentation)

### 1. 像素准确率 (Pixel Accuracy, PA)
正确分类的像素点占总像素点的比例。
`PA = ΣTP_i / Σ(TP_i + FP_i)`
* **缺陷**：受背景类别（通常占据大部分图像）主导，无法客观评价小目标分割效果。

### 2. 平均交并比 (mIoU)
分别计算每个类别的 IoU，然后取平均。是语义分割最权威的评价指标。
`mIoU = 1/(k+1) × Σ[TP_i / (TP_i + FP_i + FN_i)]`

### 3. Dice 系数 (Dice Coefficient)
集合相似度度量函数，常用于医学图像分割。
`Dice = 2 × |X∩Y| / (|X| + |Y|)`
* **特性**：等价于 F1-Score，对前景背景极度不平衡的场景（如微小病灶分割）效果优于 PA。

---

## 五、自然语言处理 (NLP)

### 1. 文本生成与翻译
* **BLEU (Bilingual Evaluation Understudy)**
  * **原理**：计算候选文本与参考文本的 N-gram **精确率 (Precision)**。
  * **适用**：机器翻译。关注"生成的词是否在参考译文中出现"。
* **ROUGE (Recall-Oriented Understudy for Gisting Evaluation)**
  * **原理**：计算 N-gram 的 **召回率 (Recall)**。
  * **适用**：文本摘要。关注"参考摘要的内容是否被模型生成"。

### 2. 语言模型评估
* **困惑度 (Perplexity, PPL)**
  * **定义**：`PPL = exp(-1/N × Σ log P(w_i | w_<i))`
  * **含义**：衡量概率分布预测的不确定性。**PPL 越低**，表示模型生成的文本越自然、越符合语言规律。

---

## 六、图像生成与底层视觉 (Generative Models & Low-level Vision)

### 1. 生成质量 (GANs/Diffusion)
* **FID (Fréchet Inception Distance)**
  * **原理**：计算生成图像与真实图像在特征空间（Inception Network 特征层）分布的 Fréchet 距离。
  * **标准**：**FID 越低**，表示生成图像的质量越高且分布越接近真实数据。
* **IS (Inception Score)**
  * **原理**：基于 Inception 网络输出的条件概率计算 KL 散度，衡量生成图像的**清晰度**和**多样性**。
  * **标准**：IS 越高越好。

### 2. 图像复原 (超分/去噪)
* **PSNR (Peak Signal-to-Noise Ratio)**：峰值信噪比。基于像素误差（MSE）计算。`PSNR = 10 × log₁₀(MAX_I² / MSE)`。数值越高表示失真越小，但与人眼主观感知并不完全一致。
* **SSIM (Structural Similarity)**：结构相似性。从亮度、对比度、结构三个维度衡量图像相似度，更符合人类视觉感知系统 (HVS)。取值范围 `[0, 1]`。

---

## 七、总结与建议

在选择评价指标时，应遵循以下原则：

1.  **任务导向**：
    * 分类（不平衡）：优先参考 AUC, F1-Score。
    * 分类（概率）：参考 Log Loss。
    * 回归（含离群值）：优先参考 MAE。
2.  **指标组合**：避免单一指标陷阱。
    * 例如：在目标检测中，同时关注 mAP（准确性）和 FPS（推理速度）。
    * 例如：在图像生成中，结合 FID（客观指标）和人工评估（主观指标）。
3.  **基准对比**：
    * 所有指标需与 Baseline（基线模型）对比才有意义。

